"use strict";(self["webpackChunksanyue_imghub"]=self["webpackChunksanyue_imghub"]||[]).push([[515],{2515:function(e,a,t){t.r(a),t.d(a,{default:function(){return x}});var l=t(9114),n=(t(5331),t(694),t(47)),i=(t(9648),t(7815)),o=(t(2907),t(5558)),s=(t(8075),t(7138)),r=(t(5802),t(7009)),u=(t(8450),t(4752),t(4880)),d=(t(7128),t(8507)),c=(t(213),t(8600)),g=t(4211),h=t(6768),m=t(4232);const p={class:"container"},b={class:"header-content"},f={class:"header-action"},v={class:"main-container"},k={style:{margin:"8px"}},C={style:{"text-align":"center"}},y=["src"],w={key:2,style:{width:"100px",height:"100px",display:"flex","justify-content":"center","align-items":"center"}},L={class:"pagination-container"};function T(e,a,t,T,F,S){const D=g.A,_=c.A,x=(0,h.g2)("font-awesome-icon"),A=d.R7,$=u.bZ,E=s.o8,z=r.Zq,P=s.Up,W=o.qi,I=i.aQ,X=n.S2,M=l.A;return(0,h.uX)(),(0,h.CE)("div",p,[(0,h.bF)($,null,{default:(0,h.k6)(()=>[(0,h.Lk)("div",b,[(0,h.bF)(D,{activeTab:"customerConfig"}),(0,h.Lk)("div",f,[(0,h.bF)(_),(0,h.bF)(A,{disabled:S.disableTooltip,content:e.$t("nav.logout"),placement:"bottom"},{default:(0,h.k6)(()=>[(0,h.bF)(x,{icon:"sign-out-alt",class:"header-icon",onClick:S.handleLogout},null,8,["onClick"])]),_:1},8,["disabled","content"])])])]),_:1}),(0,h.Lk)("div",v,[(0,h.bo)(((0,h.uX)(),(0,h.Wv)(P,{data:S.paginatedData,"default-sort":{prop:"count",order:"descending"},class:"main-table","table-layout":"fixed"},{default:(0,h.k6)(()=>[(0,h.bF)(E,{type:"expand"},{default:(0,h.k6)(a=>[(0,h.Lk)("div",k,[(0,h.Lk)("h3",C,(0,m.v_)(e.$t("customerConfig.uploadFileList")),1),(0,h.bF)(P,{data:a.row.data,style:{width:"100%"},"default-sort":{prop:"metadata.TimeStamp",order:"descending"},"table-layout":"fixed","max-height":400},{default:(0,h.k6)(()=>[(0,h.bF)(E,{prop:"metadata.FileName",label:e.$t("customerConfig.fileName")},null,8,["label"]),(0,h.bF)(E,{label:e.$t("customerConfig.filePreview")},{default:(0,h.k6)(({row:e})=>[e.metadata?.FileType?.includes("image")?((0,h.uX)(),(0,h.Wv)(z,{key:0,src:"/file/"+e.id+"?from=admin",fit:"cover",lazy:"",style:{width:"100px",height:"100px"}},null,8,["src"])):e.metadata?.FileType?.includes("video")?((0,h.uX)(),(0,h.CE)("video",{key:1,src:"/file/"+e.id+"?from=admin",controls:"",style:{width:"100px",height:"100px"}},null,8,y)):((0,h.uX)(),(0,h.CE)("div",w,[(0,h.bF)(x,{icon:"file",style:{"font-size":"2em"}})]))]),_:1},8,["label"]),(0,h.bF)(E,{formatter:S.formatTimeStamp,label:e.$t("customerConfig.uploadTime"),prop:"metadata.TimeStamp",sortable:"","sort-method":S.sortByTimestamp},{default:(0,h.k6)(({row:e})=>[(0,h.eW)((0,m.v_)(S.formatTimeStamp(e.metadata.TimeStamp)),1)]),_:1},8,["formatter","label","sort-method"])]),_:1},8,["data"])])]),_:1}),(0,h.bF)(E,{prop:"ip",label:e.$t("customerConfig.ipAddress")},null,8,["label"]),(0,h.bF)(E,{prop:"address",label:e.$t("customerConfig.address")},null,8,["label"]),(0,h.bF)(E,{prop:"count",label:e.$t("customerConfig.uploadCount"),sortable:""},null,8,["label"]),(0,h.bF)(E,{label:e.$t("customerConfig.allowUpload")},{default:(0,h.k6)(({row:a})=>[(0,h.bF)(W,{modelValue:a.enable,"onUpdate:modelValue":e=>a.enable=e,"active-color":"#13ce66","inactive-color":"#ff4949","active-text":e.$t("customerConfig.allow"),"inactive-text":e.$t("customerConfig.forbid"),onChange:e=>S.handleSwitchEnable(a)},null,8,["modelValue","onUpdate:modelValue","active-text","inactive-text","onChange"])]),_:1},8,["label"])]),_:1},8,["data"])),[[M,F.loading]]),(0,h.Lk)("div",L,[(0,h.bF)(I,{background:"",layout:"prev, pager, next",total:F.dealedData.length,"current-page":F.currentPage,"page-size":F.pageSize,"pager-count":S.pagerCount,onCurrentChange:S.handlePageChange},null,8,["total","current-page","page-size","pager-count","onCurrentChange"]),F.currentPage===Math.ceil(F.dealedData.length/F.pageSize)?((0,h.uX)(),(0,h.Wv)(X,{key:0,type:"primary",onClick:S.loadMoreData,loading:F.loading,class:"load-more"},{default:(0,h.k6)(()=>[(0,h.eW)((0,m.v_)(e.$t("customerConfig.loadMore")),1)]),_:1},8,["onClick","loading"])):(0,h.Q3)("",!0)])])])}t(4114),t(8111),t(2489),t(1701);var F=t(797),S={name:"CustomerConfig",data(){return{tableData:[],dealedData:[],blockipList:[],loading:!1,currentPage:1,pageSize:10}},components:{DashboardTabs:g.A,LanguageSwitcher:c.A},computed:{disableTooltip(){return window.innerWidth<768},pagerCount(){return window.innerWidth<768?3:7},paginatedData(){const e=(this.currentPage-1)*this.pageSize,a=e+this.pageSize;return this.dealedData.slice(e,a)}},methods:{handleLogout(){this.$store.commit("setCredentials",null),this.$router.push("/adminLogin")},formatTimeStamp(e){return new Date(e).toLocaleString()},sortByTimestamp(e,a){return new Date(e.metadata.TimeStamp)-new Date(a.metadata.TimeStamp)},async handleSwitchEnable(e){const a=e.ip,t=e.enable;t?(this.blockipList=this.blockipList.filter(e=>e!==a),await(0,F.A)("/api/manage/cusConfig/whiteip",{method:"POST",body:a})):(this.blockipList.push(a),await(0,F.A)("/api/manage/cusConfig/blockip",{method:"POST",body:a}))},handlePageChange(e){this.currentPage=e,e===Math.ceil(this.dealedData.length/this.pageSize)&&this.loadMoreData()},loadMoreData(){this.loading=!0;const e=this.dealedData.length,a=20;(0,F.A)(`/api/manage/cusConfig/list?start=${e}&count=${a}`,{method:"GET"}).then(e=>e.json()).then(e=>{this.dealedData=this.dealedData.concat(e.map(e=>{const a=!this.blockipList.includes(e.ip);return{ip:e.ip,address:e.address,count:e.count,data:e.data,enable:a}}))}).catch(()=>{this.$message.error(this.$t("customerConfig.loadError"))}).finally(()=>{this.loading=!1})},handleSizeChange(e){this.pageSize=e,this.currentPage=1}},mounted(){this.loading=!0,(0,F.A)("/api/manage/check",{method:"GET"}).then(e=>e.text()).then(e=>{if("true"==e)return this.showLogoutButton=!0,(0,F.A)("/api/manage/cusConfig/list?count=20",{method:"GET"});if("Not using basic auth."==e)return(0,F.A)("/api/manage/cusConfig/list?count=20",{method:"GET"});throw new Error("Unauthorized")}).then(e=>e.json()).then(async e=>{const a=await(0,F.A)("/api/manage/cusConfig/blockipList",{method:"GET"});this.blockipList=(await a.text()).split(","),this.dealedData=e.map(e=>{const a=!this.blockipList.includes(e.ip);return{ip:e.ip,address:e.address,count:e.count,data:e.data,enable:a}})}).catch(e=>{"Unauthorized"!==e.message&&this.$message.error(this.$t("customerConfig.syncError"))}).finally(()=>{this.loading=!1})}},D=t(1241);const _=(0,D.A)(S,[["render",T],["__scopeId","data-v-97fc8cf8"]]);var x=_},2907:function(e,a,t){t(5331),t(6808),t(6711)},4752:function(e,a,t){t(5331),t(8736),t(8785)},5802:function(e,a,t){t(5331),t(8736),t(213),t(5970)},8600:function(e,a,t){t.d(a,{A:function(){return h}});var l=t(2086),n=(t(5331),t(670),t(8830),t(3597),t(6768)),i=t(4232);const o={class:"language-trigger"},s={class:"language-text"};function r(e,a,t,r,u,d){const c=(0,n.g2)("font-awesome-icon"),g=l.c6,h=l.Iy,m=l.dW;return(0,n.uX)(),(0,n.Wv)(m,{onCommand:d.changeLanguage,trigger:"click"},{dropdown:(0,n.k6)(()=>[(0,n.bF)(h,null,{default:(0,n.k6)(()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.languages,e=>((0,n.uX)(),(0,n.Wv)(g,{key:e.value,command:e.value,class:(0,i.C4)({"is-active":d.currentLocale===e.value})},{default:(0,n.k6)(()=>[(0,n.eW)((0,i.v_)(e.label),1)]),_:2},1032,["command","class"]))),128))]),_:1})]),default:(0,n.k6)(()=>[(0,n.Lk)("span",o,[(0,n.bF)(c,{icon:"globe",class:"language-icon"}),(0,n.Lk)("span",s,(0,i.v_)(d.currentLanguageLabel),1)])]),_:1},8,["onCommand"])}t(8111),t(116);var u=t(3257),d={name:"LanguageSwitcher",data(){return{languages:[{value:"zh-CN",label:"简体中文"},{value:"zh-TW",label:"繁體中文"},{value:"en",label:"English"},{value:"ja",label:"日本語"},{value:"ko-KR",label:"한국어"},{value:"es",label:"Español"},{value:"pt-BR",label:"Português"},{value:"fr-FR",label:"Français"},{value:"de-DE",label:"Deutsch"},{value:"it-IT",label:"Italiano"},{value:"nl-NL",label:"Nederlands"},{value:"pl-PL",label:"Polski"},{value:"cs-CZ",label:"Čeština"},{value:"uk-UA",label:"Українська"},{value:"ru-RU",label:"Русский"},{value:"tr-TR",label:"Türkçe"},{value:"ar-SA",label:"العربية"},{value:"hi",label:"हिंदी"},{value:"bn-BD",label:"বাংলা"},{value:"th-TH",label:"ไทย"},{value:"vi-VN",label:"Tiếng Việt"},{value:"ms-MY",label:"Bahasa Melayu"},{value:"id-ID",label:"Bahasa Indonesia"}]}},computed:{currentLocale(){return u.A.global.locale},currentLanguageLabel(){const e=this.languages.find(e=>e.value===this.currentLocale);return e?e.label:"简体中文"}},methods:{changeLanguage(e){u.A.global.locale=e,localStorage.setItem("locale",e)}}},c=t(1241);const g=(0,c.A)(d,[["render",r],["__scopeId","data-v-a5a77658"]]);var h=g}}]);
//# sourceMappingURL=515.6b4dfb2e.js.map